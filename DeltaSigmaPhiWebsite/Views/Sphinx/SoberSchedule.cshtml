@model SoberSignupModel
@{
    ViewBag.Title = "Sober Schedule";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<div class="container">
    <div class="page-header">
        <div class="row">
            <div class="col-md-6">
                <h1>
                    @ViewBag.Title
                </h1>
            </div>
            <div class="col-md-6 text-right" style="margin-top: 30px">
                @if (User.IsInRole("Administrator"))
                {
                    @Html.ActionLink("Manage", "SoberScheduleManager", "Sphinx")
                }
            </div>
        </div>
    </div>
</div>

<div class="container">
    <div class="row">
        <div class="col-lg-12">
            <table class="table table-responsive table-striped table-condensed" style="text-align:left;">
                <thead>
                    <tr>
                        <th>Requested</th>
                        <th>Volunteer</th>
                        <th>Date</th>
                        <th>Action</th>
                    </tr>
                </thead>
                @foreach (var item in Model.SoberSignUpsNeededList.OrderBy(s => s.Shift))
                {
                    <tr>
                        <td>@item.SoberType</td>
                        <td>@item.Name</td>
                        <td>@item.Shift.ToShortDateString()</td>
                        <td>
                            @if (item.UID == null)
                            {
                                using (Html.BeginForm("CreateSoberReservation", "Sphinx",
                                    new SoberReservationModel {UID = null, Shift = item.Shift, Name = User.Identity.Name, SoberType = item.SoberType},
                                    FormMethod.Post, new { id="reserveForm" }))
                                {
                                        <a href="javascript:document.getElementById('reserveForm').submit()">Volunteer</a>
                                }
                            }
                            @if (User.Identity.Name == @item.UserName)
                            {
                                using (Html.BeginForm("CancelSoberReservation", "Sphinx", 
                                    new SoberReservationModel { UID = item.UID, Shift = item.Shift, SoberType = item.SoberType, UserName = @item.UserName },
                                    FormMethod.Post, new { id = "cancelForm" }))
                                {
                                        <a href="javascript:document.getElementById('reserveForm').submit()">Cancel</a>
                                }
                            }

                        </td>
                    </tr>
                }
            </table>
        </div>
    </div>
</div>

@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")
}